parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"horc":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Vector2d=void 0;var i=function(){function e(n,i){t(this,e),this.x=n,this.y=i}return n(e,[{key:"copy",value:function(){return new e(this.x,this.y)}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"mul",value:function(t){return this.x*=t,this.y*=t,this}},{key:"div",value:function(t){return this.x/=t,this.y/=t,this}},{key:"dst",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"len",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"norm",value:function(){var t=this.len();return 0!==t&&(this.x/=t,this.y/=t),this}},{key:"limit",value:function(t){return this.len()>t?this.norm().mul(t):this}},{key:"angle",value:function(t){return this.angleRad(t)*(180/Math.PI)}},{key:"angleRad",value:function(t){var e=this.x*t.x+this.y*t.y,n=this.x*t.y-this.y*t.x;return Math.atan2(n,e)}},{key:"rotate",value:function(t){return this.rotateRad(t*(Math.PI/180))}},{key:"rotateRad",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.x*e-this.y*n,r=this.x*n+this.y*e;return this.x=i,this.y=r,this}}]),e}();exports.Vector2d=i;
},{}],"zlXV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Boid=void 0;var e=require("./vector2d"),t=require("./ui");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}var i=function(){function a(e,t,o){r(this,a),this.id=e,this.pos=t,this.vel=o}return o(a,[{key:"move",value:function(e,r,a){var o=this.calculateForces(e,r,a);this.vel.add(o).limit(t.parameters.maxSpeed),this.pos.add(this.vel),this.pos.x>t.parameters.width&&(this.pos.x-=t.parameters.width),this.pos.x<0&&(this.pos.x+=t.parameters.width),this.pos.y>t.parameters.height&&(this.pos.y-=t.parameters.height),this.pos.y<0&&(this.pos.y+=t.parameters.height)}},{key:"calculateForces",value:function(r,a,o){var i=this.findNeighbors(r),n=this.calculateSeparationForce(i).mul(t.parameters.separationWeight),s=this.calculateAlignmentForce(i).mul(t.parameters.alignmentWeight),c=this.calculateCohesionForce(i).mul(t.parameters.cohesionWeight),u=this.calculateObstacleAvoidanceForce(o),l=this.calculatePredatorAvoidanceForce(a);return new e.Vector2d(0,0).add(n).add(s).add(c).add(u).add(l)}},{key:"findNeighbors",value:function(e){var r=this;return e.filter(function(e){return e.pos.dst(r.pos)<=t.parameters.neighborRadius&&e.id!==r.id})}},{key:"getPos",value:function(){return this.pos.copy()}},{key:"getVel",value:function(){return this.vel.copy()}},{key:"calculateAlignmentForce",value:function(t){var r=new e.Vector2d(0,0);return t.forEach(function(e){r.add(e.getVel())}),r.norm(),r}},{key:"calculateSeparationForce",value:function(r){var a=this,o=new e.Vector2d(0,0);return r.forEach(function(e){var r=a.getPos().sub(e.getPos()),i=r.len(),n=(t.parameters.neighborRadius-i)/t.parameters.neighborRadius;r.norm().mul(n),o.add(r)}),o}},{key:"calculateCohesionForce",value:function(t){if(0===t.length)return new e.Vector2d(0,0);var r=new e.Vector2d(0,0);return t.forEach(function(e){r.add(e.getPos())}),r.div(t.length),r.sub(this.getPos()).norm(),r}},{key:"calculatePredatorAvoidanceForce",value:function(t){var r=this,a=new e.Vector2d(0,0);return t.forEach(function(e){if(!(e.getPos().dst(r.getPos())>50)){var t=r.getPos().sub(e.getPos());a.add(t)}}),a.norm().mul(10)}},{key:"calculateObstacleAvoidanceForce",value:function(t){var r=this,a=new e.Vector2d(0,0);return t.forEach(function(e){if(!(e.getPos().dst(r.getPos())>100)){var t=e.getPos().sub(r.getPos()).angle(r.getVel());0<t&&t<60?a.add(r.getVel().rotate(60).norm().mul(5)):-60<t&&t<0&&a.add(r.getVel().rotate(-60).norm().mul(5))}}),a}}]),a}();exports.Boid=i;
},{"./vector2d":"horc","./ui":"lA8h"}],"Y2Sz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Predator=void 0;var e=require("./vector2d"),t=require("./ui"),r=require("./world");function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}var n=100,i=function(){function e(t,r,o){a(this,e),this.id=t,this.pos=r,this.vel=o,this.lastVelChange=performance.now()}return s(e,[{key:"getPos",value:function(){return this.pos.copy()}},{key:"getVel",value:function(){return this.vel.copy()}},{key:"move",value:function(e,a,o){performance.now()-this.lastVelChange>500&&Math.random()>.9&&(this.lastVelChange=performance.now(),this.vel.rotate((0,r.randomInRange)(-60,60)).norm().mul((0,r.randomInRange)(t.parameters.predatorMaxSpeed/3,t.parameters.predatorMaxSpeed))),this.pos.add(this.vel),this.pos.x>t.parameters.width&&(this.pos.x-=t.parameters.width),this.pos.x<0&&(this.pos.x+=t.parameters.width),this.pos.y>t.parameters.height&&(this.pos.y-=t.parameters.height),this.pos.y<0&&(this.pos.y+=t.parameters.height)}}]),e}();exports.Predator=i;
},{"./vector2d":"horc","./ui":"lA8h","./world":"R4T5"}],"oRXi":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Obstacle=void 0;var r=function(){function t(n,r){e(this,t),this.pos=n,this.radius=r}return n(t,[{key:"getPos",value:function(){return this.pos.copy()}},{key:"getRadius",value:function(){return this.radius}}]),t}();exports.Obstacle=r;
},{}],"R4T5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.randomInRange=d,exports.world=exports.World2=void 0;var e=require("./vector2d"),t=require("./ui"),r=require("./boid"),o=require("./predator"),s=require("./obstacle");function n(e){return u(e)||i(e)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,r){return t&&l(e.prototype,t),r&&l(e,r),e}function d(e,t){return Math.random()*(t-e)+e}var p=function(){function a(){c(this,a),this.boids=[],this.predators=[],this.obstacles=[]}return h(a,[{key:"setNumBoids",value:function(o){if(o<this.boids.length)this.boids=this.boids.slice(0,o);else for(var s=this.boids.length;s<o;s++){var n=new e.Vector2d(0,1).rotate(d(0,360)).mul(d(.5,.75*t.parameters.maxSpeed)),a=new e.Vector2d(d(0,t.parameters.width),d(0,t.parameters.height));this.boids.push(new r.Boid(s,a,n))}}},{key:"setNumPredators",value:function(r){if(r<this.predators.length)this.predators=this.predators.slice(0,r);else for(var s=this.predators.length;s<r;s++){var n=new e.Vector2d(0,1).rotate(d(0,360)).mul(d(.5,t.parameters.predatorMaxSpeed)),a=new e.Vector2d(d(0,t.parameters.width),d(0,t.parameters.height));this.predators.push(new o.Predator(s,a,n))}}},{key:"setNumObstacles",value:function(r){if(r<this.obstacles.length)this.obstacles=this.obstacles.slice(0,r);else for(var o=this.obstacles.length;o<r;o++){var n=new e.Vector2d(d(0,t.parameters.width),d(0,t.parameters.height)),a=d(15,40);this.obstacles.push(new s.Obstacle(n,a))}}},{key:"update",value:function(t){var r=this,o=n(this.predators);t&&o.push({getPos:function(){return t.copy()},getVel:function(){return new e.Vector2d(0,0)}}),this.boids.forEach(function(e){return e.move(r.boids,o,r.obstacles)}),this.predators.forEach(function(e){return e.move()})}}]),a}();exports.World2=p;var f=new p;exports.world=f;
},{"./vector2d":"horc","./ui":"lA8h","./boid":"zlXV","./predator":"Y2Sz","./obstacle":"oRXi"}],"lA8h":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createUI=i,exports.parameters=void 0;var e=require("./world");function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach(function(t){n(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o={numBoids:300,neighborRadius:40,separationWeight:1.3,alignmentWeight:1,cohesionWeight:1.5,maxSpeed:5,numPredators:1,predatorMaxSpeed:7.5,numObstacles:1,width:1200,height:900};exports.parameters=o;var a=r({},o);function i(){c(),l("numBoids",1,2e3,1),l("separationWeight",0,4,.01),l("alignmentWeight",0,4,.01),l("cohesionWeight",0,4,.01),l("maxSpeed",1,10,.5),l("neighborRadius",0,100,5),l("numPredators",0,30,1),l("predatorMaxSpeed",1,10,.5),l("numObstacles",0,30,1),d(),u()}function c(){var e=JSON.parse(localStorage.getItem("params"));Object.assign(o,e),s()}function s(){localStorage.setItem("params",JSON.stringify(o)),e.world.setNumBoids(o.numBoids),e.world.setNumPredators(o.numPredators),e.world.setNumObstacles(o.numObstacles)}function d(){var e=document.createElement("button");e.innerText="reset";var t=document.getElementById("controls");e.addEventListener("click",function(){console.log("reset"),Object.assign(o,a),s(),window.location.reload()}),t.appendChild(e)}function l(e,t,r,n){var a=document.createElement("div");a.classList.add("slider");var i=document.createElement("label");i.htmlFor=e,i.innerText=e+": "+o[e];var c=document.createElement("input");c.type="range",c.id=e,c.min=t,c.max=r,c.step=n,c.value=o[e],c.addEventListener("input",function(){o[e]=c.value,i.innerText=e+": "+o[e],s()}),a.appendChild(i),a.appendChild(c),document.getElementById("controls").appendChild(a)}function u(){var e=document.createElement("div");e.id="fpscounter",document.getElementById("controls").appendChild(e)}
},{"./world":"R4T5"}],"I3Wr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.startRender=i;var e=require("./ui"),t=require("./world"),r=require("./vector2d"),a=document.getElementById("drawme"),o=a.getContext("2d"),d=void 0;function i(){a.addEventListener("mousemove",function(t){var o=a.getBoundingClientRect(),i=t.offsetX*(a.width/o.width),n=e.parameters.height-t.offsetY*(a.height/o.height);d=new r.Vector2d(i,n)}),a.addEventListener("mouseleave",function(){d=void 0}),window.requestAnimationFrame(n)}function n(){if(c(),t.world.update(d),o.fillStyle="#15143c",o.fillRect(0,0,e.parameters.width,e.parameters.height),t.world.boids.forEach(function(e){f(e,"#6ec5fe","#8ef6fe")}),t.world.predators.forEach(function(e){f(e,"#fd59bd","#fdaedc")}),o.fillStyle="#ac2fff",t.world.obstacles.forEach(function(t){var r=o.createRadialGradient(t.pos.x,e.parameters.height-t.pos.y,0,t.pos.x,e.parameters.height-t.pos.y,50);r.addColorStop(1,"#ac2fff"),r.addColorStop(.5,"#c868ff"),r.addColorStop(0,"#d5a2ff"),o.beginPath(),o.fillStyle=r,o.arc(t.pos.x,e.parameters.height-t.pos.y,t.radius,0,2*Math.PI),o.fill()}),d){var r=o.createRadialGradient(d.x,e.parameters.height-d.y,0,d.x,e.parameters.height-d.y,10);r.addColorStop(1,"#ac2fff"),r.addColorStop(.5,"#c868ff"),r.addColorStop(0,"#d5a2ff"),o.beginPath(),o.fillStyle=r,o.arc(d.x,e.parameters.height-d.y,10,0,2*Math.PI),o.fill()}window.requestAnimationFrame(n)}function f(t,a,d){var i=-t.vel.angleRad(new r.Vector2d(1,0)),n=new r.Vector2d(-6,-3).rotateRad(i).add(t.pos),f=new r.Vector2d(-6,3).rotateRad(i).add(t.pos),l=new r.Vector2d(6,0).rotateRad(i).add(t.pos);o.beginPath(),o.fillStyle=a,o.strokeStyle=d,o.moveTo(n.x,e.parameters.height-n.y),o.lineTo(f.x,e.parameters.height-f.y),o.lineTo(l.x,e.parameters.height-l.y),o.lineTo(n.x,e.parameters.height-n.y),o.fill(),o.stroke()}var l=0,s=performance.now();function c(){var e=performance.now();l+=(e-s-l)/20,s=e,document.getElementById("fpscounter").innerText=(1e3/l).toFixed(0)+" fps"}
},{"./ui":"lA8h","./world":"R4T5","./vector2d":"horc"}],"Focm":[function(require,module,exports) {
"use strict";var e=require("./vector2d"),r=require("./ui"),t=require("./render");(0,r.createUI)(),(0,t.startRender)();
},{"./vector2d":"horc","./ui":"lA8h","./render":"I3Wr"}]},{},["Focm"], null)
//# sourceMappingURL=/src.4b412885.js.map